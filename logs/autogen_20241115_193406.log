2024-11-15 19:34:06.082 | Process-4848 | Thread-4576839168 | AutogenGame | INFO | Starting Autogen CYOA game
2024-11-15 19:34:06.083 | Process-4848 | Thread-4576839168 | AutogenGame | INFO | Setting up agents
2024-11-15 19:34:06.084 | Process-4848 | Thread-4576839168 | httpx | DEBUG | load_ssl_context verify=True cert=None trust_env=True http2=False
2024-11-15 19:34:06.084 | Process-4848 | Thread-4576839168 | httpx | DEBUG | load_verify_locations cafile='/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/certifi/cacert.pem'
2024-11-15 19:34:06.097 | Process-4848 | Thread-4576839168 | AutogenGame | INFO | Starting chat
2024-11-15 19:34:06.097 | Process-4848 | Thread-4576839168 | AutogenGame | INFO | AGENT_EVENT: {
  "event_type": "message_send",
  "sender": "user_proxy",
  "recipient": "assistant",
  "message_preview": "Create a text-based Choose Your Own Adventure game with the following requirements:\n1. Title: 'Teleport Massive CYOA'\n2. Start with Sam Iker waking from a dream about flying around a skyscraper\n3. Each scene should have 3 main choices plus an 'other' option\n4. Generate and use markdown files for scenarios\n5. Implement tracking tables for game state\n6. Include logging for all game actions\n7. Create a librarian function to manage game state\n8. Generate character dialogue based on current game stat",
  "timestamp": "2024-11-15T19:34:06.097354",
  "message_length": 628,
  "request_reply": false,
  "silent_mode": false
}
2024-11-15 19:34:06.099 | Process-4848 | Thread-4576839168 | AutogenGame | INFO | AGENT_EVENT: {
  "event_type": "message_receive",
  "receiver": "assistant",
  "sender": "user_proxy",
  "message_preview": "Create a text-based Choose Your Own Adventure game with the following requirements:\n1. Title: 'Teleport Massive CYOA'\n2. Start with Sam Iker waking from a dream about flying around a skyscraper\n3. Each scene should have 3 main choices plus an 'other' option\n4. Generate and use markdown files for scenarios\n5. Implement tracking tables for game state\n6. Include logging for all game actions\n7. Create a librarian function to manage game state\n8. Generate character dialogue based on current game stat",
  "timestamp": "2024-11-15T19:34:06.097636",
  "message_length": 628,
  "request_reply": false,
  "silent_mode": false
}
2024-11-15 19:34:06.181 | Process-4848 | Thread-4576839168 | openai._base_client | DEBUG | Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': "You are a Python developer creating a Choose Your Own Adventure game.\nYour code should implement:\n1. Text-based UI with three main choices plus an 'other' option\n2. Game starts with Sam Iker waking from a skyscraper dream\n3. Title: 'Teleport Massive CYOA'\n4. Logging system for game setup and execution\n5. Obsidian-style markdown files for events/choices\n6. Scenario generation using markdown files\n7. Tables for tracking:\n   - Scenario index\n   - Character stats/states\n   - Location stats/states\n   - Item stats/states\n   - Player actions\n8. Game state management via librarian function\n9. Character dialogue generation based on game state\n\nWrite code incrementally, testing each component. Use clear comments and logging.", 'role': 'system'}, {'content': "Create a text-based Choose Your Own Adventure game with the following requirements:\n1. Title: 'Teleport Massive CYOA'\n2. Start with Sam Iker waking from a dream about flying around a skyscraper\n3. Each scene should have 3 main choices plus an 'other' option\n4. Generate and use markdown files for scenarios\n5. Implement tracking tables for game state\n6. Include logging for all game actions\n7. Create a librarian function to manage game state\n8. Generate character dialogue based on current game state\n9. Keep the implementation clean and modular\n\nPlease start by creating the basic game structure and we'll build up from there.", 'role': 'user', 'name': 'user_proxy'}], 'model': 'gpt-4', 'stream': False}}
2024-11-15 19:34:06.207 | Process-4848 | Thread-4576839168 | openai._base_client | DEBUG | Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-11-15 19:34:06.209 | Process-4848 | Thread-4576839168 | httpcore.connection | DEBUG | connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-11-15 19:34:06.338 | Process-4848 | Thread-4576839168 | httpcore.connection | DEBUG | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11d564c40>
2024-11-15 19:34:06.339 | Process-4848 | Thread-4576839168 | httpcore.connection | DEBUG | start_tls.started ssl_context=<ssl.SSLContext object at 0x11d4f15c0> server_hostname='api.openai.com' timeout=5.0
2024-11-15 19:34:06.816 | Process-4848 | Thread-4576839168 | httpcore.connection | DEBUG | start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11d529000>
2024-11-15 19:34:06.816 | Process-4848 | Thread-4576839168 | httpcore.http11 | DEBUG | send_request_headers.started request=<Request [b'POST']>
2024-11-15 19:34:06.817 | Process-4848 | Thread-4576839168 | httpcore.http11 | DEBUG | send_request_headers.complete
2024-11-15 19:34:06.818 | Process-4848 | Thread-4576839168 | httpcore.http11 | DEBUG | send_request_body.started request=<Request [b'POST']>
2024-11-15 19:34:06.818 | Process-4848 | Thread-4576839168 | httpcore.http11 | DEBUG | send_request_body.complete
2024-11-15 19:34:06.819 | Process-4848 | Thread-4576839168 | httpcore.http11 | DEBUG | receive_response_headers.started request=<Request [b'POST']>
2024-11-15 19:34:07.320 | Process-4848 | Thread-4576839168 | httpcore.http11 | DEBUG | receive_response_headers.complete return_value=(b'HTTP/1.1', 401, b'Unauthorized', [(b'Date', b'Sat, 16 Nov 2024 03:34:07 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'322'), (b'Connection', b'keep-alive'), (b'vary', b'Origin'), (b'x-request-id', b'req_a44abb480c492798d621e2c40f1fa935'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=T4TmJmq5DsT4PRVhmMWgPjfc5bMVJ3s9OxB5qIFeYiE-1731728047-1.0.1.1-VbJqFpRJir3bO5p23mdcYRYXpZylWDIv1sjjj88vocq38ZKFr4yybOZt1HqvjnPIZr.rNGkhHNrSSN8piCA3Gg; path=/; expires=Sat, 16-Nov-24 04:04:07 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=SFuTUvpGEHMP4FEo.CVSBfj42hwZp.Bhq2ozq16LWbk-1731728047594-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8e346c68d8e32349-SJC'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-11-15 19:34:07.322 | Process-4848 | Thread-4576839168 | httpx | INFO | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 401 Unauthorized"
2024-11-15 19:34:07.323 | Process-4848 | Thread-4576839168 | httpcore.http11 | DEBUG | receive_response_body.started request=<Request [b'POST']>
2024-11-15 19:34:07.323 | Process-4848 | Thread-4576839168 | httpcore.http11 | DEBUG | receive_response_body.complete
2024-11-15 19:34:07.323 | Process-4848 | Thread-4576839168 | httpcore.http11 | DEBUG | response_closed.started
2024-11-15 19:34:07.324 | Process-4848 | Thread-4576839168 | httpcore.http11 | DEBUG | response_closed.complete
2024-11-15 19:34:07.324 | Process-4848 | Thread-4576839168 | openai._base_client | DEBUG | HTTP Response: POST https://api.openai.com/v1/chat/completions "401 Unauthorized" Headers([('date', 'Sat, 16 Nov 2024 03:34:07 GMT'), ('content-type', 'application/json; charset=utf-8'), ('content-length', '322'), ('connection', 'keep-alive'), ('vary', 'Origin'), ('x-request-id', 'req_a44abb480c492798d621e2c40f1fa935'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=T4TmJmq5DsT4PRVhmMWgPjfc5bMVJ3s9OxB5qIFeYiE-1731728047-1.0.1.1-VbJqFpRJir3bO5p23mdcYRYXpZylWDIv1sjjj88vocq38ZKFr4yybOZt1HqvjnPIZr.rNGkhHNrSSN8piCA3Gg; path=/; expires=Sat, 16-Nov-24 04:04:07 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=SFuTUvpGEHMP4FEo.CVSBfj42hwZp.Bhq2ozq16LWbk-1731728047594-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8e346c68d8e32349-SJC'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-11-15 19:34:07.325 | Process-4848 | Thread-4576839168 | openai._base_client | DEBUG | request_id: req_a44abb480c492798d621e2c40f1fa935
2024-11-15 19:34:07.325 | Process-4848 | Thread-4576839168 | openai._base_client | DEBUG | Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/openai/_base_client.py", line 1038, in _request
    response.raise_for_status()
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/httpx/_models.py", line 763, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '401 Unauthorized' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/401
2024-11-15 19:34:07.328 | Process-4848 | Thread-4576839168 | openai._base_client | DEBUG | Not retrying
2024-11-15 19:34:07.328 | Process-4848 | Thread-4576839168 | openai._base_client | DEBUG | Re-raising status error
2024-11-15 19:34:07.330 | Process-4848 | Thread-4576839168 | AutogenGame | ERROR | Error during chat: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-************************************************************6789. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):
  File "/Users/ctavolazzi/Code/teleport-massive/cyoa/autogen_game_openai.py", line 213, in <module>
    chat_result = user_proxy.initiate_chat(
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/autogen/agentchat/conversable_agent.py", line 1114, in initiate_chat
    self.send(msg2send, recipient, silent=silent)
  File "/Users/ctavolazzi/Code/teleport-massive/cyoa/autogen_game_openai.py", line 80, in send
    return super().send(message, recipient, request_reply, silent)
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/autogen/agentchat/conversable_agent.py", line 748, in send
    recipient.receive(message, self, request_reply, silent)
  File "/Users/ctavolazzi/Code/teleport-massive/cyoa/autogen_game_openai.py", line 123, in receive
    return super().receive(message, sender, request_reply, silent)
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/autogen/agentchat/conversable_agent.py", line 914, in receive
    reply = self.generate_reply(messages=self.chat_messages[sender], sender=sender)
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/autogen/agentchat/conversable_agent.py", line 2068, in generate_reply
    final, reply = reply_func(self, messages=messages, sender=sender, config=reply_func_tuple["config"])
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/autogen/agentchat/conversable_agent.py", line 1436, in generate_oai_reply
    extracted_response = self._generate_oai_reply_from_client(
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/autogen/agentchat/conversable_agent.py", line 1455, in _generate_oai_reply_from_client
    response = llm_client.create(
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/autogen/oai/client.py", line 777, in create
    response = client.create(params)
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/autogen/oai/client.py", line 342, in create
    response = completions.create(**params)
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/openai/_utils/_utils.py", line 275, in wrapper
    return func(*args, **kwargs)
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/openai/resources/chat/completions.py", line 829, in create
    return self._post(
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/openai/_base_client.py", line 1278, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/openai/_base_client.py", line 955, in request
    return self._request(
  File "/Users/ctavolazzi/.pyenv/versions/3.10.13/lib/python3.10/site-packages/openai/_base_client.py", line 1059, in _request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-************************************************************6789. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
